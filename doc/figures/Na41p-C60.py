#!/usr/bin/env python
import numpy as np
import matplotlib as mpl
from numpy import loadtxt as Read
from matplotlib.backends.backend_agg import FigureCanvasAgg as FigCanvas
from matplotlib.figure import Figure
from matplotlib import collections as Coll
mpl.rcParams['text.latex.preamble'] = [r'\usepackage{mathrsfs}']

levels_na41p = [\
[(1, -7.9302142936682830), (3, -7.9302142936682830)],\
[(1, -7.3480266849353700), (3, -7.3480266849353700)],\
[(1, -7.3480266849353700), (3, -7.3480266849353700)],\
[(1, -7.3380945289555840), (3, -7.3380945289555840)],\
[(1, -6.6421633257144400), (3, -6.6421633257144400)],\
[(1, -6.6420272687832105), (3, -6.6420272687832105)],\
[(1, -6.6295100311100565), (3, -6.6295100311100565)],\
[(1, -6.6284215756602170), (3, -6.6284215756602170)],\
[(1, -6.6046116126949770), (3, -6.6046116126949770)],\
[(1, -6.3349467749972370), (3, -6.3349467749972370)],\
[(1, -5.8437812532571530), (3, -5.8437812532571530)],\
[(1, -5.8304476739966190), (3, -5.8304476739966190)],\
[(1, -5.8277265353720200), (3, -5.8277265353720200)],\
[(1, -5.7958892134642130), (3, -5.7958892134642130)],\
[(1, -5.7830998619286000), (3, -5.7830998619286000)],\
[(1, -5.7802426663727710), (3, -5.7802426663727710)],\
[(1, -5.7108536314455010), (3, -5.7108536314455010)],\
[(1, -5.3603709765971760), (3, -5.3603709765971760)],\
[(1, -5.3599628058034865), (3, -5.3599628058034865)],\
[(1, -5.2954718204004940), (3, -5.2954718204004940)],\
[(1, -4.9249887966613680), (3, -4.9249887966613680)]\
]
col_na41p = np.array([\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0.121569, 0.470588, 0.705882),\
(0.890196, 0.101961, 0.109804),\
])
lc_na41p = Coll.LineCollection(levels_na41p, colors=col_na41p, linewidths=1)

levels_c60 = [\
[(1, -26.4194), (3, -26.4194)],\
[(1, -25.9933), (3, -25.9933)],\
[(1, -25.9825), (3, -25.9825)],\
[(1, -25.8447), (3, -25.8447)],\
[(1, -25.1485), (3, -25.1485)],\
[(1, -25.1433), (3, -25.1433)],\
[(1, -25.1235), (3, -25.1235)],\
[(1, -25.0458), (3, -25.0458)],\
[(1, -24.8675), (3, -24.8675)],\
[(1, -24.3819), (3, -24.3819)],\
[(1, -24.3414), (3, -24.3414)],\
[(1, -24.2177), (3, -24.2177)],\
[(1, -23.2223), (3, -23.2223)],\
[(1, -23.1531), (3, -23.1531)],\
[(1, -23.1421), (3, -23.1421)],\
[(1, -22.9648), (3, -22.9648)],\
[(1, -22.3751), (3, -22.3751)],\
[(1, -22.3204), (3, -22.3204)],\
[(1, -22.2452), (3, -22.2452)],\
[(1, -22.2144), (3, -22.2144)],\
[(1, -22.1373), (3, -22.1373)],\
[(1, -21.6457), (3, -21.6457)],\
[(1, -21.3754), (3, -21.3754)],\
[(1, -21.3468), (3, -21.3468)],\
[(1, -21.2442), (3, -21.2442)],\
[(1, -20.8281), (3, -20.8281)],\
[(1, -20.7869), (3, -20.7869)],\
[(1, -20.7332), (3, -20.7332)],\
[(1, -20.0201), (3, -20.0201)],\
[(1, -19.9997), (3, -19.9997)],\
[(1, -19.9140), (3, -19.9140)],\
[(1, -19.4625), (3, -19.4625)],\
[(1, -19.4345), (3, -19.4345)],\
[(1, -19.3299), (3, -19.3299)],\
[(1, -19.2975), (3, -19.2975)],\
[(1, -19.1138), (3, -19.1138)],\
[(1, -18.6507), (3, -18.6507)],\
[(1, -18.0847), (3, -18.0847)],\
[(1, -18.0752), (3, -18.0752)],\
[(1, -17.6224), (3, -17.6224)],\
[(1, -17.5772), (3, -17.5772)],\
[(1, -17.5047), (3, -17.5047)],\
[(1, -17.4270), (3, -17.4270)],\
[(1, -17.1011), (3, -17.1011)],\
[(1, -17.0245), (3, -17.0245)],\
[(1, -16.8398), (3, -16.8398)],\
[(1, -16.7082), (3, -16.7082)],\
[(1, -16.6296), (3, -16.6296)],\
[(1, -16.4583), (3, -16.4583)],\
[(1, -15.9917), (3, -15.9917)],\
[(1, -15.8572), (3, -15.8572)],\
[(1, -15.6080), (3, -15.6080)],\
[(1, -15.4045), (3, -15.4045)],\
[(1, -15.3498), (3, -15.3498)],\
[(1, -15.3018), (3, -15.3018)],\
[(1, -15.2914), (3, -15.2914)],\
[(1, -15.2218), (3, -15.2218)],\
[(1, -15.1289), (3, -15.1289)],\
[(1, -15.1284), (3, -15.1284)],\
[(1, -15.0433), (3, -15.0433)],\
[(1, -14.9033), (3, -14.9033)],\
[(1, -14.7690), (3, -14.7690)],\
[(1, -14.6373), (3, -14.6373)],\
[(1, -14.5665), (3, -14.5665)],\
[(1, -14.2212), (3, -14.2212)],\
[(1, -14.0530), (3, -14.0530)],\
[(1, -14.0495), (3, -14.0495)],\
[(1, -14.0125), (3, -14.0125)],\
[(1, -13.9543), (3, -13.9543)],\
[(1, -13.9087), (3, -13.9087)],\
[(1, -13.8782), (3, -13.8782)],\
[(1, -13.7400), (3, -13.7400)],\
[(1, -13.6755), (3, -13.6755)],\
[(1, -13.6065), (3, -13.6065)],\
[(1, -13.2907), (3, -13.2907)],\
[(1, -13.2827), (3, -13.2827)],\
[(1, -13.2216), (3, -13.2216)],\
[(1, -13.0679), (3, -13.0679)],\
[(1, -12.7058), (3, -12.7058)],\
[(1, -12.6480), (3, -12.6480)],\
[(1, -12.4608), (3, -12.4608)],\
[(1, -12.4202), (3, -12.4202)],\
[(1, -12.3840), (3, -12.3840)],\
[(1, -12.3371), (3, -12.3371)],\
[(1, -12.2459), (3, -12.2459)],\
[(1, -12.1964), (3, -12.1964)],\
[(1, -11.8718), (3, -11.8718)],\
[(1, -11.8682), (3, -11.8682)],\
[(1, -11.8099), (3, -11.8099)],\
[(1, -11.6504), (3, -11.6504)],\
[(1, -11.5949), (3, -11.5949)],\
[(1, -11.5263), (3, -11.5263)],\
[(1, -11.4031), (3, -11.4031)],\
[(1, -11.2129), (3, -11.2129)],\
[(1, -11.2033), (3, -11.2033)],\
[(1, -11.1350), (3, -11.1350)],\
[(1, -10.9217), (3, -10.9217)],\
[(1, -10.9010), (3, -10.9010)],\
[(1, -10.4595), (3, -10.4595)],\
[(1, -10.3527), (3, -10.3527)],\
[(1, -10.2324), (3, -10.2324)],\
[(1, -10.1357), (3, -10.1357)],\
[(1, -10.1285), (3, -10.1285)],\
[(1, -9.93896), (3, -9.93896)],\
[(1, -9.74821), (3, -9.74821)],\
[(1, -9.68957), (3, -9.68957)],\
[(1, -9.61596), (3, -9.61596)],\
[(1, -9.58644), (3, -9.58644)],\
[(1, -9.49623), (3, -9.49623)],\
[(1, -9.43106), (3, -9.43106)],\
[(1, -9.39704), (3, -9.39704)],\
[(1, -9.32711), (3, -9.32711)],\
[(1, -9.18235), (3, -9.18235)],\
[(1, -8.96683), (3, -8.96683)],\
[(1, -8.76710), (3, -8.76710)],\
[(1, -7.84940), (3, -7.84940)],\
[(1, -7.83634), (3, -7.83634)],\
[(1, -7.70613), (3, -7.70613)],\
[(1, -7.46027), (3, -7.46027)],\
[(1, -7.02748), (3, -7.02748)],\
[(1, -5.30248), (3, -5.30248)]\
]
col_c60 = np.array([\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0, 0, 0),\
(0.121569, 0.470588, 0.705882),\
(0.890196, 0.101961, 0.109804)\
])
lc_c60 = Coll.LineCollection(levels_c60, colors=col_c60, linewidths=1)

x31,y31=Read('Na41+.spectrum-xyz.dat',skiprows=3,usecols=(1,3),unpack=True)
x32,y32=Read('Na41+.spectrum-xyz.dat',skiprows=3,usecols=(1,9),unpack=True)
x41,y41=Read('C60.spectrum-xyz.dat',skiprows=3,usecols=(1,3),unpack=True)

fig=Figure()
FigCanvas(fig)

ax1=fig.add_subplot(221)
ax1.add_collection(lc_na41p)
ax1.text(5, -5, r'$\mathrm{Na_{41}^+},~40~\mathrm{e}^-$', fontsize=20)
ax1.set_ylabel(r'$\varepsilon_i~/~[\mathrm{eV}]$')
ax1.set_xlim(0,10)
ax1.set_ylim(-27,0)
ax1.spines['right'].set_visible(False)
ax1.spines['bottom'].set_visible(False)
ax1.xaxis.set_ticks_position('none')
ax1.yaxis.set_ticks_position('left')
ax1.set_xticklabels([])
ax1.set_yticks([-25,-20,-15,-10,-5,0])
# ax1.set_yticklabels(['-30','-25','-20','-15','-10','-5','0'])

ax2=fig.add_subplot(222)
ax2.add_collection(lc_c60)
ax2.text(5, -5, r'$\mathrm{C_{60}},~240~\mathrm{e}^-$', fontsize=20)
ax2.set_xlim(0,10)
ax2.set_ylim(-27,0)
ax2.spines['right'].set_visible(False)
ax2.spines['bottom'].set_visible(False)
ax2.xaxis.set_ticks_position('none')
ax2.yaxis.set_ticks_position('left')
ax2.set_xticklabels([])
ax2.set_yticklabels([])

ax3=fig.add_subplot(223)
ax3.plot(x31,y31, color='#1f78b4', label=r'$xy$-dir.')
ax3.plot(x32,y32, color='#e31a1c', label=r'$z$-dir.')
ax3.axvline(x=5.2954718204004940, color='k', linestyle='--', linewidth=1)
ax3.legend(loc=(0.41,0.75))
ax3.set_xlim(2,6)
ax3.set_ylim(bottom=0)#, top=2.5)
ax3.set_ylabel(r'$\mathscr{F}\{\widetilde{D}(t)\}$')
ax3.set_yticks([])
ax3.set_xlabel(r'Frequency $\omega$ / [eV]')
# ax3.set_xticks([5,10,15,20,25,30,35])

ax4=fig.add_subplot(224)
ax4.plot(x41,y41, color='#1f78b4', label=r'$xyz$-dir.')
ax4.axvline(x=7.60218, color='k', linestyle='--', linewidth=1)
ax4.legend()
ax4.set_xlim(0,35)
ax4.set_ylim(bottom=0)
ax4.set_yticks([])
ax4.set_xlabel(r'Frequency $\omega$     / [eV]')
ax4.set_xticks([0,5,10,15,20,25,30,35])
ax4.set_xticklabels(['0','5','10','15','20','25','30','35'])

fig.savefig('Na41p-C60', bbox_inches='tight')
